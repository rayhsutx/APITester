{
    "actions": [
    {
        "type": "argument",
        "name": "pass parameters",
        "config": {
            "data": {
            	"cloud-host": "up.uat.kaisquare.com",
                "host": "192.168.1.130",
                "port": "80",
                "otp": "KLMUB8",
                "license": "XUHZS - CVP8F - UMJIW",
                "registration-number": "THF10P130531800076",
                "node-name": "Node TW 76",
                "dev-name": "Amtk170",
                "dev-host": "192.168.1.170",
                "dev-port": "80",
                "dev-user": "admin",
                "dev-password": "",
                "event-date-from": "09092014000000",
                "event-date-to": "09092014235959"
            }
        }
    },
    {
        "type": "http",
        "name": "registration",
        "config": {
            "url": "http://{{HOST}}/nodeapi/register",
            "data": {
                "otp": "{{OTP}}",
                "license-number": "{{LICENSE}}",
                "registration-number": "{{REGISTRATION-NUMBER}}",
                "device-name": "{{node-name}}",
                "device-address": "New Taipei",
                "device-latitude": "0",
                "device-longitude": "0"
            },
            "values": {
	        	"result": "result"
            },
	        "check": {
	        	"result": "ok"
	        }
        }
    },
    {
        "type": "http",
        "name": "login",
        "config": {
            "url": "http://{{host}}/api/kaisquare/login",
            "data": {
                "user-name": "admin",
                "password": "admin"
            },
            "values": {
            	"result": "result",
                "session": "session-key",
                "userid": "user-id"
            },
	        "check": {
	        	"result": "ok"
	        }
        }
    },
    {
    	"type": "http",
    	"name": "adddevice",
    	"config": {
    		"url": "http://{{host}}/api/kaisquare/adddevicetobucket",
    		"data": {
    			"session-key": "{{session}}",
		        "registration-number": "",
		        "device-name": "{{dev-name}}",
		        "model-id": "111",
		        "device-key": "",
		        "device-host": "{{dev-host}}",
		        "device-port": "{{dev-port}}",
		        "device-label": "",
		        "device-login": "{{dev-user}}",
		        "device-password": "{{dev-password}}",
		        "device-address": "New Taipei",
		        "device-latitude": "0",
		        "device-longitude": "0",
		        "cloud-recording-enabled": "true"
    		},
	    	"values": {
	    		"result": "result",
	    		"platform-device-id": "id",
	    		"core-device-id": "device-id"
	    	},
	    	"check": {
	    		"result": "ok",
	    		"platform-device-id": ":isdigit",
	    		"core-device-id": ":isdigit"
	    	}
    	}
    },
    {
    	"type": "http",
    	"name": "getlivevideourl",
    	"delay": 10000,
    	"retry": 6,
    	"config": {
    		"url": "http://{{host}}/api/kaisquare/getlivevideourl",
    		"data": {
    			"session-key": "{{session}}",
    			"device-id": "{{platform-device-id}}",
    			"channel-id": "0",
    			"stream-type": "rtmp/h264"
    		},
    		"values": {
    			"result": "result",
    			"video-url": "url:0"
    		},
    		"check": {
    			"result": "ok",
    			"video-url": ":notempty"
    		}
    	}
    },
    {
    	"type": "shell",
    	"name": "livevideo",
    	"config": {
    		"timeout": 10000,
    		"command": "/opt/local/bin/ffmpeg -i {{video-url}}",
    		"values": {
    			"resolution": "re:(\\d{3}x\\d{3})"
    		},
    		"check": {
    			"resolution": "640x480"
    		}
    	}
    },
    {
    	"type": "http",
    	"name": "addareaintrusion",
    	"config": {
    		"url": "http://{{host}}/api/kaisquare/addareaintrusion",
    		"data": {
    			"session-key": "{{session}}",
    			"device-id": "{{platform-device-id}}",
    			"channel-id": "0",
    			"thresholds": "{\"maskPercent\":10,\"mask-base64\":\"/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAMCAgICAgMCAgIDAwMDBAYEBAQEBAgGBgUGCQgKCgkICQkKDA8MCgsOCwkJDRENDg8QEBEQCgwSExIQEw8QEBD/2wBDAQMDAwQDBAgEBAgQCwkLEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBD/wAARCAEsAZADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD8qqKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKdDFJPKkEKlnkYIqjuScAU2ruiTrbavZzuuVWZcj2zipm3GLa3N8NThVrwp1HaLaTfZN6s6+x8BackA+3zSyzEfNsbaoPtxTW+HtiWJS/nC54BUEiuror5X6/ib35z9+/1SyXkUHh1p63+bvd/M5P8A4V7Z/wDQRm/74FH/AAr2z/6CM3/fArrKKP7QxP8AP+RP+p+Sf9A6++X+Zyf/AAr2z/6CM3/fArI13wdcaTA15bz/AGiBPv5XDKPX3Feh1Fdwi4tZrcjIljZMeuRitKWZV4zTlK6OTH8E5TXw840KXJOzs03v03dmeP0VJdW8tpcy2sww8TlGx6g1HX06aauj8JnCVOThJWaCiiimSFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABU1l/x+Qf9dU/mKhqay/4/IP8Arqn8xUy+FmtD+LH1X5nr9FFFfEn9RhRRRQAUUUUAeceNbT7NrkkijC3CLIPr0P6j9awa7f4gWEskNvqEaMyxZSTHRQcYP55/SuIr6zAVPaYeL7afcfz1xbg3gs4rRtZSfMv+3tdPndBRRRXYfOBRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUqsVYMpwQcg0lFAJ21R7DbyNLbxSt1dFY/UipKpaLcfatJtJ8YLQrn6gYNXa+JmuWTR/UOFqqtQhUTvdJ/egoooqTcKKKKAIb2AXNnPblQ3mxsmD3yK8gIKkqRgjgivZa8l1i3a11S7t2OSkzc+ozkV7eTT1nD0Z+W+JWHvHD4hf3ov8GvyZUooor3T8pCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA9I8FSvJoEQds7HdV+mc/1rdrmfANx5mkywEcxTH8iAf8a6avkMZHlxE15n9GcNVVWyjDyTv7iX3afoFFFFcx7gUUUUAFeW+Jv+Q9e/8AXU/yr1Lpya8o124jutYu7iFgyPK20juBxmvXydP2sn5H5z4kTisFRhfVzv8Acn/mijRRRX0J+OhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAdd8PJXFxeQ7vkKK2PcE/wCNdvXn3gO6EOsNbnGLiIgfUc/yzXoNfL5pHlxLfex+7cB1lUyWEU/hcl6a3/JhRRRXnn2QUUUUAHXg149dIsdzLGgwqyMo+gNew15Be/8AH5P/ANdX/ma9rJvin8j8w8S0vZ4Z+cv/AG0hooor3j8mCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAuaNcG01a0uAM7JlyPUE4P6V6zXjsMnkzJKBnYwbHrg17BFIssaSrnDqGGfQ14Ocx96EvU/WfDWteliKN9nF29U1+iHUUUV4p+nhRRRQAV5Be/8fk//XV/5mvX68gvf+Pyf/rq/wDM17WTfFP5H5h4l/wsP6y/JENFFFe8fkwUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABXr9l/x5wf9ck/kK8gr16xINlbkHjyk/kK8XOfhh8/0P0/w0/i4j0j+bJ6KKK8E/WQooooAK8funWS6mdTkNIxH0zXqes3LWelXdyn3kibb9cYFeT17uTQ0nP0R+UeJWITnh8Ot0pP77Jfkwooor2z8uCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK9I8GX7Xuiokj7ntmMR9do+7+hx+Feb1d0rWL7R5zPZSAbuHRhlWHuK48dhniqXLHdbH0nC2dxyLHqvVu4SVpW/B28n+Fz1iiuGHxCvcc6fBn/eNH/Cwrz/oHQ/99mvD/szE9vxR+q/69ZJ/z8f/AIDL/I7miuAuPH2qyACC3t4fU4LH9ap3HjDX7gAfbBEB/wA80AzVxynES3sjlr+IOU0r8ilL0VvzaOv8Y38Npos0DsPMuQI0XueeT+A/pXm1SXFzcXchmup5JXP8TsSf1qOvaweF+q0+S92fmHEmevP8Z9Y5eWKVkvLV3fm7hRRRXWfPhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAH//Z\",\"mask-path\":\"[{\\\"x\\\":166,\\\"y\\\":154,\\\"beginPath\\\":true,\\\"tool\\\":\\\"brush\\\",\\\"globalAlpha\\\":0.5,\\\"globalCompositeOperation\\\":\\\"source-over\\\",\\\"strokeStyle\\\":\\\"red\\\",\\\"lineWidth\\\":15,\\\"lineCap\\\":\\\"round\\\",\\\"lineJoin\\\":\\\"round\\\",\\\"lapse\\\":0},{\\\"x\\\":167,\\\"y\\\":155,\\\"lapse\\\":99},{\\\"x\\\":167,\\\"y\\\":157,\\\"lapse\\\":16},{\\\"x\\\":167,\\\"y\\\":163,\\\"lapse\\\":27},{\\\"x\\\":167,\\\"y\\\":169,\\\"lapse\\\":6},{\\\"x\\\":167,\\\"y\\\":175,\\\"lapse\\\":21},{\\\"x\\\":168,\\\"y\\\":179,\\\"lapse\\\":12},{\\\"x\\\":168,\\\"y\\\":185,\\\"lapse\\\":23},{\\\"x\\\":169,\\\"y\\\":188,\\\"lapse\\\":11},{\\\"x\\\":169,\\\"y\\\":191,\\\"lapse\\\":18},{\\\"x\\\":170,\\\"y\\\":193,\\\"lapse\\\":27},{\\\"x\\\":170,\\\"y\\\":195,\\\"lapse\\\":5},{\\\"x\\\":170,\\\"y\\\":198,\\\"lapse\\\":23},{\\\"x\\\":170,\\\"y\\\":201,\\\"lapse\\\":10},{\\\"x\\\":171,\\\"y\\\":205,\\\"lapse\\\":23},{\\\"x\\\":171,\\\"y\\\":207,\\\"lapse\\\":30},{\\\"x\\\":172,\\\"y\\\":209,\\\"lapse\\\":7},{\\\"x\\\":172,\\\"y\\\":211,\\\"lapse\\\":32},{\\\"x\\\":172,\\\"y\\\":214,\\\"lapse\\\":28},{\\\"x\\\":172,\\\"y\\\":216,\\\"lapse\\\":4},{\\\"x\\\":172,\\\"y\\\":217,\\\"lapse\\\":29},{\\\"x\\\":173,\\\"y\\\":218,\\\"lapse\\\":37},{\\\"x\\\":173,\\\"y\\\":221,\\\"lapse\\\":2},{\\\"x\\\":174,\\\"y\\\":222,\\\"lapse\\\":10},{\\\"x\\\":174,\\\"y\\\":223,\\\"lapse\\\":19},{\\\"x\\\":174,\\\"y\\\":225,\\\"lapse\\\":37},{\\\"x\\\":175,\\\"y\\\":228,\\\"lapse\\\":33},{\\\"x\\\":175,\\\"y\\\":231,\\\"lapse\\\":30},{\\\"x\\\":175,\\\"y\\\":234,\\\"lapse\\\":11},{\\\"x\\\":176,\\\"y\\\":235,\\\"lapse\\\":26},{\\\"x\\\":176,\\\"y\\\":237,\\\"lapse\\\":29},{\\\"x\\\":176,\\\"y\\\":238,\\\"lapse\\\":12},{\\\"x\\\":176,\\\"y\\\":238,\\\"lapse\\\":55},{\\\"x\\\":176,\\\"y\\\":239,\\\"lapse\\\":33},{\\\"x\\\":176,\\\"y\\\":241,\\\"lapse\\\":11},{\\\"x\\\":176,\\\"y\\\":244,\\\"lapse\\\":23},{\\\"x\\\":176,\\\"y\\\":247,\\\"lapse\\\":16},{\\\"x\\\":176,\\\"y\\\":249,\\\"lapse\\\":18},{\\\"x\\\":176,\\\"y\\\":251,\\\"lapse\\\":32},{\\\"x\\\":176,\\\"y\\\":253,\\\"lapse\\\":3},{\\\"x\\\":176,\\\"y\\\":254,\\\"lapse\\\":20},{\\\"x\\\":177,\\\"y\\\":255,\\\"lapse\\\":37},{\\\"x\\\":177,\\\"y\\\":256,\\\"lapse\\\":11},{\\\"x\\\":178,\\\"y\\\":258,\\\"lapse\\\":33},{\\\"x\\\":178,\\\"y\\\":258,\\\"lapse\\\":2},{\\\"x\\\":178,\\\"y\\\":259,\\\"lapse\\\":17},{\\\"x\\\":178,\\\"y\\\":260,\\\"lapse\\\":42},{\\\"x\\\":179,\\\"y\\\":260,\\\"lapse\\\":98},{\\\"x\\\":180,\\\"y\\\":260,\\\"lapse\\\":67},{\\\"x\\\":181,\\\"y\\\":260,\\\"lapse\\\":95},{\\\"x\\\":182,\\\"y\\\":260,\\\"lapse\\\":20},{\\\"x\\\":182,\\\"y\\\":260,\\\"lapse\\\":30},{\\\"x\\\":185,\\\"y\\\":260,\\\"lapse\\\":17},{\\\"x\\\":187,\\\"y\\\":260,\\\"lapse\\\":30},{\\\"x\\\":189,\\\"y\\\":260,\\\"lapse\\\":3},{\\\"x\\\":190,\\\"y\\\":260,\\\"lapse\\\":21},{\\\"x\\\":192,\\\"y\\\":260,\\\"lapse\\\":14},{\\\"x\\\":193,\\\"y\\\":260,\\\"lapse\\\":23},{\\\"x\\\":194,\\\"y\\\":260,\\\"lapse\\\":10},{\\\"x\\\":195,\\\"y\\\":259,\\\"lapse\\\":19},{\\\"x\\\":197,\\\"y\\\":259,\\\"lapse\\\":34},{\\\"x\\\":199,\\\"y\\\":259,\\\"lapse\\\":12},{\\\"x\\\":200,\\\"y\\\":259,\\\"lapse\\\":28},{\\\"x\\\":201,\\\"y\\\":259,\\\"lapse\\\":25},{\\\"x\\\":201,\\\"y\\\":259,\\\"lapse\\\":14},{\\\"x\\\":202,\\\"y\\\":259,\\\"lapse\\\":24},{\\\"x\\\":202,\\\"y\\\":258,\\\"lapse\\\":75},{\\\"x\\\":203,\\\"y\\\":258,\\\"lapse\\\":153},{\\\"x\\\":204,\\\"y\\\":258,\\\"lapse\\\":196},{\\\"x\\\":205,\\\"y\\\":258,\\\"lapse\\\":16},{\\\"x\\\":206,\\\"y\\\":258,\\\"lapse\\\":33},{\\\"x\\\":207,\\\"y\\\":258,\\\"lapse\\\":21},{\\\"x\\\":207,\\\"y\\\":257,\\\"lapse\\\":13},{\\\"x\\\":207,\\\"y\\\":256,\\\"lapse\\\":217},{\\\"x\\\":207,\\\"y\\\":252,\\\"lapse\\\":15},{\\\"x\\\":208,\\\"y\\\":249,\\\"lapse\\\":27},{\\\"x\\\":209,\\\"y\\\":244,\\\"lapse\\\":7},{\\\"x\\\":209,\\\"y\\\":240,\\\"lapse\\\":16},{\\\"x\\\":209,\\\"y\\\":236,\\\"lapse\\\":27},{\\\"x\\\":209,\\\"y\\\":233,\\\"lapse\\\":11},{\\\"x\\\":209,\\\"y\\\":229,\\\"lapse\\\":23},{\\\"x\\\":209,\\\"y\\\":225,\\\"lapse\\\":10},{\\\"x\\\":209,\\\"y\\\":221,\\\"lapse\\\":24},{\\\"x\\\":209,\\\"y\\\":218,\\\"lapse\\\":9},{\\\"x\\\":209,\\\"y\\\":215,\\\"lapse\\\":24},{\\\"x\\\":209,\\\"y\\\":212,\\\"lapse\\\":19},{\\\"x\\\":208,\\\"y\\\":208,\\\"lapse\\\":18},{\\\"x\\\":208,\\\"y\\\":205,\\\"lapse\\\":19},{\\\"x\\\":207,\\\"y\\\":202,\\\"lapse\\\":40},{\\\"x\\\":206,\\\"y\\\":197,\\\"lapse\\\":2},{\\\"x\\\":206,\\\"y\\\":195,\\\"lapse\\\":30},{\\\"x\\\":205,\\\"y\\\":193,\\\"lapse\\\":7},{\\\"x\\\":205,\\\"y\\\":192,\\\"lapse\\\":27},{\\\"x\\\":204,\\\"y\\\":191,\\\"lapse\\\":33},{\\\"x\\\":204,\\\"y\\\":187,\\\"lapse\\\":3},{\\\"x\\\":204,\\\"y\\\":186,\\\"lapse\\\":31},{\\\"x\\\":203,\\\"y\\\":184,\\\"lapse\\\":13},{\\\"x\\\":203,\\\"y\\\":183,\\\"lapse\\\":62},{\\\"x\\\":202,\\\"y\\\":181,\\\"lapse\\\":4},{\\\"x\\\":202,\\\"y\\\":178,\\\"lapse\\\":26},{\\\"x\\\":201,\\\"y\\\":176,\\\"lapse\\\":7},{\\\"x\\\":201,\\\"y\\\":174,\\\"lapse\\\":27},{\\\"x\\\":200,\\\"y\\\":173,\\\"lapse\\\":25},{\\\"x\\\":199,\\\"y\\\":171,\\\"lapse\\\":5},{\\\"x\\\":199,\\\"y\\\":169,\\\"lapse\\\":23},{\\\"x\\\":199,\\\"y\\\":168,\\\"lapse\\\":32},{\\\"x\\\":199,\\\"y\\\":168,\\\"lapse\\\":44},{\\\"x\\\":197,\\\"y\\\":168,\\\"lapse\\\":310},{\\\"x\\\":196,\\\"y\\\":168,\\\"lapse\\\":41},{\\\"x\\\":195,\\\"y\\\":168,\\\"lapse\\\":8},{\\\"x\\\":194,\\\"y\\\":168,\\\"lapse\\\":17},{\\\"x\\\":192,\\\"y\\\":168,\\\"lapse\\\":26},{\\\"x\\\":191,\\\"y\\\":168,\\\"lapse\\\":7},{\\\"x\\\":190,\\\"y\\\":168,\\\"lapse\\\":25},{\\\"x\\\":189,\\\"y\\\":168,\\\"lapse\\\":8},{\\\"x\\\":188,\\\"y\\\":168,\\\"lapse\\\":27},{\\\"x\\\":185,\\\"y\\\":168,\\\"lapse\\\":6},{\\\"x\\\":182,\\\"y\\\":168,\\\"lapse\\\":22},{\\\"x\\\":180,\\\"y\\\":168,\\\"lapse\\\":31},{\\\"x\\\":178,\\\"y\\\":168,\\\"lapse\\\":6},{\\\"x\\\":177,\\\"y\\\":168,\\\"lapse\\\":32},{\\\"x\\\":176,\\\"y\\\":168,\\\"lapse\\\":26},{\\\"x\\\":175,\\\"y\\\":168,\\\"lapse\\\":83},{\\\"x\\\":173,\\\"y\\\":169,\\\"lapse\\\":24},{\\\"x\\\":173,\\\"y\\\":169,\\\"lapse\\\":33},{\\\"x\\\":172,\\\"y\\\":169,\\\"lapse\\\":541},{\\\"x\\\":171,\\\"y\\\":169,\\\"lapse\\\":66},{\\\"x\\\":170,\\\"y\\\":169,\\\"lapse\\\":67},{\\\"x\\\":170,\\\"y\\\":168,\\\"lapse\\\":16},{\\\"x\\\":170,\\\"y\\\":167,\\\"lapse\\\":107},{\\\"x\\\":169,\\\"y\\\":167,\\\"lapse\\\":10},{\\\"x\\\":169,\\\"y\\\":165,\\\"lapse\\\":16},{\\\"x\\\":168,\\\"y\\\":164,\\\"lapse\\\":26},{\\\"x\\\":168,\\\"y\\\":162,\\\"lapse\\\":7},{\\\"x\\\":168,\\\"y\\\":161,\\\"lapse\\\":27},{\\\"x\\\":168,\\\"y\\\":159,\\\"lapse\\\":6},{\\\"x\\\":168,\\\"y\\\":158,\\\"lapse\\\":22},{\\\"x\\\":168,\\\"y\\\":157,\\\"lapse\\\":11},{\\\"x\\\":168,\\\"y\\\":156,\\\"lapse\\\":33},{\\\"x\\\":168,\\\"y\\\":155,\\\"lapse\\\":33},{\\\"x\\\":169,\\\"y\\\":155,\\\"lapse\\\":283},{\\\"x\\\":170,\\\"y\\\":155,\\\"lapse\\\":17},{\\\"x\\\":172,\\\"y\\\":155,\\\"lapse\\\":25},{\\\"x\\\":174,\\\"y\\\":155,\\\"lapse\\\":7},{\\\"x\\\":176,\\\"y\\\":155,\\\"lapse\\\":22},{\\\"x\\\":178,\\\"y\\\":155,\\\"lapse\\\":12},{\\\"x\\\":180,\\\"y\\\":155,\\\"lapse\\\":22},{\\\"x\\\":183,\\\"y\\\":155,\\\"lapse\\\":13},{\\\"x\\\":186,\\\"y\\\":155,\\\"lapse\\\":31},{\\\"x\\\":187,\\\"y\\\":155,\\\"lapse\\\":23},{\\\"x\\\":188,\\\"y\\\":155,\\\"lapse\\\":11},{\\\"x\\\":189,\\\"y\\\":155,\\\"lapse\\\":24},{\\\"x\\\":190,\\\"y\\\":155,\\\"lapse\\\":9},{\\\"x\\\":191,\\\"y\\\":155,\\\"lapse\\\":23},{\\\"x\\\":192,\\\"y\\\":155,\\\"lapse\\\":33},{\\\"x\\\":193,\\\"y\\\":155,\\\"lapse\\\":3},{\\\"x\\\":195,\\\"y\\\":155,\\\"lapse\\\":33},{\\\"x\\\":195,\\\"y\\\":155,\\\"lapse\\\":33},{\\\"x\\\":196,\\\"y\\\":155,\\\"lapse\\\":3},{\\\"x\\\":198,\\\"y\\\":155,\\\"lapse\\\":26},{\\\"x\\\":199,\\\"y\\\":155,\\\"lapse\\\":24},{\\\"x\\\":200,\\\"y\\\":155,\\\"lapse\\\":21},{\\\"x\\\":200,\\\"y\\\":156,\\\"lapse\\\":25},{\\\"x\\\":200,\\\"y\\\":157,\\\"lapse\\\":241},{\\\"x\\\":200,\\\"y\\\":159,\\\"lapse\\\":40},{\\\"x\\\":199,\\\"y\\\":161,\\\"lapse\\\":10},{\\\"x\\\":199,\\\"y\\\":164,\\\"lapse\\\":26},{\\\"x\\\":199,\\\"y\\\":165,\\\"lapse\\\":8},{\\\"x\\\":198,\\\"y\\\":168,\\\"lapse\\\":23},{\\\"x\\\":198,\\\"y\\\":170,\\\"lapse\\\":10},{\\\"x\\\":198,\\\"y\\\":174,\\\"lapse\\\":29},{\\\"x\\\":198,\\\"y\\\":177,\\\"lapse\\\":5},{\\\"x\\\":198,\\\"y\\\":180,\\\"lapse\\\":20},{\\\"x\\\":198,\\\"y\\\":183,\\\"lapse\\\":12},{\\\"x\\\":198,\\\"y\\\":187,\\\"lapse\\\":24},{\\\"x\\\":198,\\\"y\\\":190,\\\"lapse\\\":9},{\\\"x\\\":198,\\\"y\\\":194,\\\"lapse\\\":20},{\\\"x\\\":198,\\\"y\\\":197,\\\"lapse\\\":31},{\\\"x\\\":198,\\\"y\\\":199,\\\"lapse\\\":6},{\\\"x\\\":198,\\\"y\\\":202,\\\"lapse\\\":30},{\\\"x\\\":198,\\\"y\\\":205,\\\"lapse\\\":22},{\\\"x\\\":198,\\\"y\\\":208,\\\"lapse\\\":5},{\\\"x\\\":198,\\\"y\\\":211,\\\"lapse\\\":37},{\\\"x\\\":198,\\\"y\\\":214,\\\"lapse\\\":5},{\\\"x\\\":198,\\\"y\\\":217,\\\"lapse\\\":19},{\\\"x\\\":199,\\\"y\\\":221,\\\"lapse\\\":30},{\\\"x\\\":200,\\\"y\\\":225,\\\"lapse\\\":3},{\\\"x\\\":200,\\\"y\\\":226,\\\"lapse\\\":16},{\\\"x\\\":200,\\\"y\\\":227,\\\"lapse\\\":27},{\\\"x\\\":200,\\\"y\\\":228,\\\"lapse\\\":7},{\\\"x\\\":200,\\\"y\\\":229,\\\"lapse\\\":21},{\\\"x\\\":200,\\\"y\\\":230,\\\"lapse\\\":29},{\\\"x\\\":200,\\\"y\\\":235,\\\"lapse\\\":14},{\\\"x\\\":200,\\\"y\\\":237,\\\"lapse\\\":29},{\\\"x\\\":200,\\\"y\\\":238,\\\"lapse\\\":26},{\\\"x\\\":201,\\\"y\\\":239,\\\"lapse\\\":8},{\\\"x\\\":201,\\\"y\\\":241,\\\"lapse\\\":47},{\\\"x\\\":201,\\\"y\\\":242,\\\"lapse\\\":33},{\\\"x\\\":201,\\\"y\\\":242,\\\"lapse\\\":33},{\\\"x\\\":201,\\\"y\\\":244,\\\"lapse\\\":25},{\\\"x\\\":201,\\\"y\\\":245,\\\"lapse\\\":8},{\\\"x\\\":202,\\\"y\\\":247,\\\"lapse\\\":33},{\\\"x\\\":202,\\\"y\\\":248,\\\"lapse\\\":25},{\\\"x\\\":202,\\\"y\\\":247,\\\"lapse\\\":224},{\\\"x\\\":201,\\\"y\\\":246,\\\"lapse\\\":17},{\\\"x\\\":201,\\\"y\\\":245,\\\"lapse\\\":29},{\\\"x\\\":200,\\\"y\\\":242,\\\"lapse\\\":24},{\\\"x\\\":199,\\\"y\\\":239,\\\"lapse\\\":10},{\\\"x\\\":198,\\\"y\\\":234,\\\"lapse\\\":5},{\\\"x\\\":197,\\\"y\\\":230,\\\"lapse\\\":27},{\\\"x\\\":196,\\\"y\\\":224,\\\"lapse\\\":4},{\\\"x\\\":195,\\\"y\\\":216,\\\"lapse\\\":23},{\\\"x\\\":194,\\\"y\\\":212,\\\"lapse\\\":11},{\\\"x\\\":194,\\\"y\\\":208,\\\"lapse\\\":25},{\\\"x\\\":193,\\\"y\\\":203,\\\"lapse\\\":7},{\\\"x\\\":193,\\\"y\\\":199,\\\"lapse\\\":23},{\\\"x\\\":193,\\\"y\\\":195,\\\"lapse\\\":33},{\\\"x\\\":193,\\\"y\\\":191,\\\"lapse\\\":4},{\\\"x\\\":193,\\\"y\\\":189,\\\"lapse\\\":26},{\\\"x\\\":192,\\\"y\\\":188,\\\"lapse\\\":34},{\\\"x\\\":192,\\\"y\\\":186,\\\"lapse\\\":5},{\\\"x\\\":192,\\\"y\\\":185,\\\"lapse\\\":30},{\\\"x\\\":192,\\\"y\\\":183,\\\"lapse\\\":23},{\\\"x\\\":191,\\\"y\\\":181,\\\"lapse\\\":6},{\\\"x\\\":191,\\\"y\\\":180,\\\"lapse\\\":37},{\\\"x\\\":189,\\\"y\\\":179,\\\"lapse\\\":32},{\\\"x\\\":186,\\\"y\\\":176,\\\"lapse\\\":6},{\\\"x\\\":185,\\\"y\\\":175,\\\"lapse\\\":26},{\\\"x\\\":184,\\\"y\\\":174,\\\"lapse\\\":6},{\\\"x\\\":184,\\\"y\\\":173,\\\"lapse\\\":30},{\\\"x\\\":182,\\\"y\\\":173,\\\"lapse\\\":33},{\\\"x\\\":180,\\\"y\\\":172,\\\"lapse\\\":4},{\\\"x\\\":179,\\\"y\\\":172,\\\"lapse\\\":28},{\\\"x\\\":178,\\\"y\\\":172,\\\"lapse\\\":8},{\\\"x\\\":177,\\\"y\\\":172,\\\"lapse\\\":32},{\\\"x\\\":177,\\\"y\\\":173,\\\"lapse\\\":134},{\\\"x\\\":177,\\\"y\\\":176,\\\"lapse\\\":10},{\\\"x\\\":177,\\\"y\\\":179,\\\"lapse\\\":21},{\\\"x\\\":177,\\\"y\\\":181,\\\"lapse\\\":13},{\\\"x\\\":177,\\\"y\\\":184,\\\"lapse\\\":22},{\\\"x\\\":177,\\\"y\\\":185,\\\"lapse\\\":10},{\\\"x\\\":178,\\\"y\\\":187,\\\"lapse\\\":24},{\\\"x\\\":178,\\\"y\\\":189,\\\"lapse\\\":10},{\\\"x\\\":179,\\\"y\\\":192,\\\"lapse\\\":22},{\\\"x\\\":180,\\\"y\\\":195,\\\"lapse\\\":11},{\\\"x\\\":181,\\\"y\\\":197,\\\"lapse\\\":22},{\\\"x\\\":182,\\\"y\\\":199,\\\"lapse\\\":28},{\\\"x\\\":183,\\\"y\\\":202,\\\"lapse\\\":5},{\\\"x\\\":184,\\\"y\\\":206,\\\"lapse\\\":23},{\\\"x\\\":185,\\\"y\\\":210,\\\"lapse\\\":31},{\\\"x\\\":186,\\\"y\\\":213,\\\"lapse\\\":6},{\\\"x\\\":187,\\\"y\\\":218,\\\"lapse\\\":35},{\\\"x\\\":190,\\\"y\\\":230,\\\"lapse\\\":39},{\\\"x\\\":191,\\\"y\\\":231,\\\"lapse\\\":12},{\\\"x\\\":191,\\\"y\\\":234,\\\"lapse\\\":33},{\\\"x\\\":191,\\\"y\\\":236,\\\"lapse\\\":19},{\\\"x\\\":191,\\\"y\\\":237,\\\"lapse\\\":12},{\\\"x\\\":192,\\\"y\\\":240,\\\"lapse\\\":23},{\\\"x\\\":192,\\\"y\\\":242,\\\"lapse\\\":20},{\\\"x\\\":192,\\\"y\\\":243,\\\"lapse\\\":13},{\\\"x\\\":192,\\\"y\\\":244,\\\"lapse\\\":33},{\\\"x\\\":192,\\\"y\\\":245,\\\"lapse\\\":4},{\\\"x\\\":192,\\\"y\\\":246,\\\"lapse\\\":42},{\\\"x\\\":192,\\\"y\\\":247,\\\"lapse\\\":21},{\\\"x\\\":192,\\\"y\\\":247,\\\"lapse\\\":10},{\\\"x\\\":192,\\\"y\\\":249,\\\"lapse\\\":22},{\\\"x\\\":192,\\\"y\\\":250,\\\"lapse\\\":144},{\\\"x\\\":190,\\\"y\\\":251,\\\"lapse\\\":283},{\\\"x\\\":190,\\\"y\\\":249,\\\"lapse\\\":17},{\\\"x\\\":188,\\\"y\\\":247,\\\"lapse\\\":33},{\\\"x\\\":188,\\\"y\\\":245,\\\"lapse\\\":22},{\\\"x\\\":187,\\\"y\\\":244,\\\"lapse\\\":11},{\\\"x\\\":187,\\\"y\\\":242,\\\"lapse\\\":16},{\\\"x\\\":186,\\\"y\\\":240,\\\"lapse\\\":25},{\\\"x\\\":186,\\\"y\\\":237,\\\"lapse\\\":8},{\\\"x\\\":185,\\\"y\\\":234,\\\"lapse\\\":18},{\\\"x\\\":185,\\\"y\\\":232,\\\"lapse\\\":25},{\\\"x\\\":185,\\\"y\\\":230,\\\"lapse\\\":7},{\\\"x\\\":185,\\\"y\\\":226,\\\"lapse\\\":34},{\\\"x\\\":185,\\\"y\\\":223,\\\"lapse\\\":16},{\\\"x\\\":185,\\\"y\\\":218,\\\"lapse\\\":22},{\\\"x\\\":185,\\\"y\\\":214,\\\"lapse\\\":12},{\\\"x\\\":185,\\\"y\\\":211,\\\"lapse\\\":24},{\\\"x\\\":185,\\\"y\\\":206,\\\"lapse\\\":8},{\\\"x\\\":185,\\\"y\\\":203,\\\"lapse\\\":26},{\\\"x\\\":185,\\\"y\\\":199,\\\"lapse\\\":8},{\\\"x\\\":185,\\\"y\\\":195,\\\"lapse\\\":23},{\\\"x\\\":185,\\\"y\\\":188,\\\"lapse\\\":27},{\\\"x\\\":185,\\\"y\\\":185,\\\"lapse\\\":6},{\\\"x\\\":184,\\\"y\\\":182,\\\"lapse\\\":30},{\\\"x\\\":184,\\\"y\\\":180,\\\"lapse\\\":24},{\\\"x\\\":183,\\\"y\\\":179,\\\"lapse\\\":4},{\\\"x\\\":183,\\\"y\\\":178,\\\"lapse\\\":37},{\\\"x\\\":183,\\\"y\\\":177,\\\"lapse\\\":102},{\\\"x\\\":183,\\\"y\\\":177,\\\"lapse\\\":145},{\\\"x\\\":183,\\\"y\\\":176,\\\"lapse\\\":17},{\\\"x\\\":183,\\\"y\\\":175,\\\"lapse\\\":24},{\\\"x\\\":183,\\\"y\\\":173,\\\"lapse\\\":9},{\\\"x\\\":184,\\\"y\\\":173,\\\"lapse\\\":24},{\\\"x\\\":184,\\\"y\\\":171,\\\"lapse\\\":34},{\\\"x\\\":186,\\\"y\\\":171,\\\"lapse\\\":32},{\\\"x\\\":187,\\\"y\\\":170,\\\"lapse\\\":10},{\\\"x\\\":189,\\\"y\\\":169,\\\"lapse\\\":22},{\\\"x\\\":190,\\\"y\\\":167,\\\"lapse\\\":11},{\\\"x\\\":192,\\\"y\\\":166,\\\"lapse\\\":22},{\\\"x\\\":193,\\\"y\\\":166,\\\"lapse\\\":11},{\\\"x\\\":194,\\\"y\\\":166,\\\"lapse\\\":34},{\\\"x\\\":195,\\\"y\\\":165,\\\"lapse\\\":32},{\\\"x\\\":196,\\\"y\\\":164,\\\"lapse\\\":28},{\\\"x\\\":197,\\\"y\\\":163,\\\"lapse\\\":5},{\\\"x\\\":199,\\\"y\\\":162,\\\"lapse\\\":31},{\\\"x\\\":199,\\\"y\\\":160,\\\"lapse\\\":26},{\\\"x\\\":200,\\\"y\\\":159,\\\"lapse\\\":6},{\\\"x\\\":201,\\\"y\\\":158,\\\"lapse\\\":170},{\\\"x\\\":201,\\\"y\\\":158,\\\"lapse\\\":33},{\\\"x\\\":201,\\\"y\\\":158,\\\"lapse\\\":432},{\\\"x\\\":201,\\\"y\\\":160,\\\"lapse\\\":17},{\\\"x\\\":202,\\\"y\\\":161,\\\"lapse\\\":24},{\\\"x\\\":202,\\\"y\\\":163,\\\"lapse\\\":9},{\\\"x\\\":203,\\\"y\\\":165,\\\"lapse\\\":17},{\\\"x\\\":203,\\\"y\\\":166,\\\"lapse\\\":24},{\\\"x\\\":204,\\\"y\\\":169,\\\"lapse\\\":9},{\\\"x\\\":204,\\\"y\\\":173,\\\"lapse\\\":45},{\\\"x\\\":205,\\\"y\\\":174,\\\"lapse\\\":5},{\\\"x\\\":205,\\\"y\\\":176,\\\"lapse\\\":33},{\\\"x\\\":205,\\\"y\\\":177,\\\"lapse\\\":34},{\\\"x\\\":205,\\\"y\\\":178,\\\"lapse\\\":52},{\\\"x\\\":206,\\\"y\\\":178,\\\"lapse\\\":14},{\\\"x\\\":206,\\\"y\\\":179,\\\"lapse\\\":34},{\\\"x\\\":208,\\\"y\\\":180,\\\"lapse\\\":25},{\\\"x\\\":208,\\\"y\\\":180,\\\"lapse\\\":7},{\\\"x\\\":208,\\\"y\\\":181,\\\"lapse\\\":21},{\\\"x\\\":208,\\\"y\\\":183,\\\"lapse\\\":22},{\\\"x\\\":209,\\\"y\\\":185,\\\"lapse\\\":15},{\\\"x\\\":209,\\\"y\\\":186,\\\"lapse\\\":32},{\\\"x\\\":209,\\\"y\\\":187,\\\"lapse\\\":5},{\\\"x\\\":209,\\\"y\\\":188,\\\"lapse\\\":26},{\\\"x\\\":209,\\\"y\\\":189,\\\"lapse\\\":21},{\\\"x\\\":209,\\\"y\\\":191,\\\"lapse\\\":8},{\\\"x\\\":210,\\\"y\\\":191,\\\"lapse\\\":29},{\\\"x\\\":210,\\\"y\\\":195,\\\"lapse\\\":43},{\\\"x\\\":210,\\\"y\\\":197,\\\"lapse\\\":6},{\\\"x\\\":210,\\\"y\\\":198,\\\"lapse\\\":32},{\\\"x\\\":210,\\\"y\\\":199,\\\"lapse\\\":5},{\\\"x\\\":210,\\\"y\\\":200,\\\"lapse\\\":20},{\\\"x\\\":210,\\\"y\\\":201,\\\"lapse\\\":37},{\\\"x\\\":210,\\\"y\\\":202,\\\"lapse\\\":5},{\\\"x\\\":210,\\\"y\\\":203,\\\"lapse\\\":24},{\\\"x\\\":210,\\\"y\\\":204,\\\"lapse\\\":7},{\\\"x\\\":210,\\\"y\\\":204,\\\"lapse\\\":726},{\\\"x\\\":210,\\\"y\\\":204,\\\"beginPath\\\":true,\\\"tool\\\":\\\"brush\\\",\\\"globalAlpha\\\":0.5,\\\"globalCompositeOperation\\\":\\\"source-over\\\",\\\"strokeStyle\\\":\\\"red\\\",\\\"lineWidth\\\":15,\\\"lineCap\\\":\\\"round\\\",\\\"lineJoin\\\":\\\"round\\\",\\\"lapse\\\":0},{\\\"x\\\":210,\\\"y\\\":204,\\\"lapse\\\":7}]\",\"additional-params\":{}}",
    			"recurrence-rule": ""
    		},
    		"values": {
    			"result": "result"
    		},
    		"check": {
    			"result": "ok"
    		}
    	}
    },
    {
    	"type": "http",
    	"name": "getevents",
    	"delay": 15000,
    	"retry": 10,
    	"config": {
    		"url": "http://{{host}}/api/kaisquare/getevents",
    		"data": {
    			"session-key": "{{session}}",
    			"device-id": "{{platform-device-id}}",
    			"channel-id": "0",
    			"event-id": "",
    			"skip": "0",
    			"take": "1",
    			"bound": "",
    			"rad": "",
    			"from": "{{event-date-from}}",
    			"to": "{{event-date-to}}",
    			"fields": "time,deviceName,deviceId,channelId,type,patchEventVideoURL"
    		},
    		"values": {
    			"result": "result",
    			"event-video-url": "events:0:patchEventVideoURL"
    		},
    		"check": {
    			"result": "ok",
    			"event-video-url": ":notempty"
    		}
    	}
    },
    {
    	"type": "shell",
    	"name": "download-event-video",
    	"config": {
    		"command": "/opt/local/bin/curl -b {{__COOKIE__}} http://{{host}}{{event-video-url}} -o event.mp4"
    	}
    },
    {
    	"type": "shell",
    	"name": "check-event-video",
    	"config": {
    		"command": "/opt/local/bin/ffmpeg -i event.mp4",
    		"values": {
    			"resolution": "re:(\\d{3}x\\d{3})"
    		},
    		"check": {
    			"resolution": "640x480"
    		}
    	}
    },
    {
    	"type": "shell",
    	"name": "delete-event-video",
    	"config": {
    		"command": "rm event.mp4"
    	}
    },
    {
    	"type": "http",
    	"name": "getplaybackvideourl",
    	"delay": 900000,
    	"config": {
    		"url": "http://{{host}}/api/kaisquare/getplaybackvideourl",
    		"data": {
    			"session-key": "{{session}}",
    			"device-id": "{{platform-device-id}}",
    			"channel-id": "0",
    			"stream-type": "http/h264",
    			"from": "{{event-date-from}}",
    			"to": "{{event-date-to}}"
    		},
    		"values": {
    			"result": "result",
    			"recorded-video-url": "url:0"
    		},
    		"check": {
    			"result": "ok",
    			"recorded-video-url": ":notempty"
    		}
    	}
    },
    {
    	"type": "shell",
    	"name": "download-recorded-video",
    	"timeout": 0,
    	"config": {
    		"command": "/opt/local/bin/curl -b {{__COOKIE__}} {{recorded-video-url}} -o recorded.mp4"
    	}
    },
    {
    	"type": "shell",
    	"name": "check-recorded-video",
    	"config": {
    		"command": "/opt/local/bin/ffmpeg -i recorded.mp4",
    		"values": {
    			"resolution": "re:(\\d{3}x\\d{3})"
    		},
    		"check": {
    			"resolution": "640x480"
    		}
    	}
    },
    {
    	"type": "shell",
    	"name": "delete-recorded-video",
    	"config": {
    		"command": "rm recorded.mp4"
    	}
    },
    {
    	"type": "http",
    	"name": "removedevicefrombucket",
    	"config": {
    		"url": "http://{{host}}/api/kaisquare/removedevicefrombucket",
    		"data": {
    			"session-key": "{{session}}",
		        "device-id": "{{platform-device-id}}"
    		},
	    	"values": {
	    		"result": "result"
	    	},
	    	"check": {
	    		"result": "ok"
	    	}
    	}
    },
    {
        "type": "print",
        "name": "print variables",
        "config": {
        }
    }]
}
